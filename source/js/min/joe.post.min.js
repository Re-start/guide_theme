!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o=t();for(var n in o)("object"==typeof exports?exports:e)[n]=o[n]}}(self,(function(){return t={initToc:function(){"false"!==PageAttrs.metas.enable_toc&&ThemeConfig.enable_toc&&$(".toc-container").length&&(document.body.clientWidth<=1200||(tocbot.init({tocSelector:"#js-toc",contentSelector:".joe_detail__article",ignoreSelector:".js-toc-ignore",headingSelector:"h1, h2, h3, h4, h5",collapseDepth:+(PageAttrs.metas.toc_depth||ThemeConfig.toc_depth||0),hasInnerContainers:!1,headingsOffset:-80,scrollSmoothOffset:-70,positionFixedSelector:".toc-container",positionFixedClass:"is-position-fixed",fixedSidebarOffset:"auto"}),$("#js-toc").children().length||($("#js-toc").html('<div class="toc-nodata">暂无目录</div>'),$(".toc-container").addClass("hide")),$(".toc-container").show(),$(".toc-expander i").on("click",(function(){$(this).parents(".toc-container").toggleClass("hide")}))))},initProgress:function(){if(ThemeConfig.enable_progress_bar){$(window).off("scroll");var e,t,o,n=$(".joe_progress_bar");$(window).on("scroll",(function(){e=$(window).height(),t=$("body").height(),o=t-e,window.requestAnimationFrame((function(){var e;e=Math.max(0,Math.min(1,$(window).scrollTop()/o)),n.css("width",100*e+"%")}))}))}},initCopy:function(){if("false"!==PageAttrs.metas.enable_copy&&ThemeConfig.enable_copy){var e=$(".joe_detail").attr("data-curl")||location.href;$(".joe_detail__article").on("copy",(function(t){var o=window.getSelection(),n=ThemeConfig.enable_copy_right_text?ThemeConfig.copy_right_text||"\r\n\r\n====================================<br>\n          作者：".concat(ThemeConfig.author,"<br>\n          来源：").concat(ThemeConfig.blog_title,"<br>\n          链接：").concat(e,"<br>\n          版权声明：内容遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。"):"";if(window.clipboardData){var i=o+n;return window.clipboardData.setData("Text",i),!1}var a=document.body,r=o+n,c=document.createElement("pre");c.style.position="absolute",c.style.left="-99999px",a.appendChild(c),c.innerHTML=r,o.selectAllChildren(c),setTimeout((function(){a.removeChild(c)}),0)}))}},initCode:function(){(ThemeConfig.enable_code_expander||ThemeConfig.enable_code_copy)&&$("pre[class*='language-']").length&&$("pre[class*='language-']").each((function(e,t){if(ThemeConfig.enable_code_expander){var o=$(t),n=$('<i class="joe-font joe-icon-arrow-downb code-expander" title="折叠/展开"></i>');n.on("click",(function(){var e=n.parent("pre").siblings(".toolbar").find(".autofold-tip");e&&e.remove(),n.parent("pre").toggleClass("close")})),o.prepend(n)}if(ThemeConfig.enable_code_copy){var i=$(t).find("code[class*='language-']").text(),a=$('<span class="copy-button"><i class="joe-font joe-icon-copy" title="复制代码"></i></span>');new ClipboardJS(a[0],{text:function(){return i}}).on("success",(function(){return Qmsg.success("复制成功！")})),$(t).addClass("copyable").append(a)}}))},foldCode:function(){ThemeConfig.enable_code_expander&&ThemeConfig.fold_long_code&&$("pre[class*='language-']").each((function(e,t){var o=$(t);o.height()>ThemeConfig.long_code_height&&(o.siblings(".toolbar").find(".toolbar-item span").eq(0).append('<em class="autofold-tip"><内容过长，已自动折叠></em>'),o.addClass("close"))}))},initAside:function(){ThemeConfig.enable_post_aside&&ThemeConfig.enable_aside_expander&&$(".aside-expander").on("click",(function(){var e=$(this);e.hasClass("active")?(e.removeClass("active"),e.html("隐藏侧边栏")):(e.addClass("active"),e.html("显示侧边栏")),$(".joe_aside").toggleClass("hide")}))},initShare:function(){"false"!==PageAttrs.metas.enable_share&&ThemeConfig.enable_share&&(ThemeConfig.enable_share_link&&$(".icon-share-link").length&&new ClipboardJS($(".icon-share-link")[0],{text:function(){return location.href}}).on("success",(function(){return Qmsg.success("文章链接已复制")})),ThemeConfig.enable_share_weixin&&$("#qrcode_wx").length&&$("#qrcode_wx").qrcode({width:140,height:140,render:"canvas",typeNumber:-1,correctLevel:0,background:"#ffffff",foreground:"#000000",text:location.href}))},initLike:function(){if("false"!==PageAttrs.metas.enable_like&&ThemeConfig.enable_like&&$(".joe_detail__agree").length){var e=$(".joe_detail").attr("data-cid"),t=+($(".joe_detail").attr("data-clikes")||0),o=localStorage.getItem(encryption("agree"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree")))):[],n=$(".joe_detail__agree .icon"),i=$(".joe_detail__agree .icon-like"),a=$(".joe_detail__agree .icon-unlike"),r=$(".joe_detail__agree .text");o.includes(e)?a.addClass("active"):i.addClass("active"),r.html(t);var c=!1;i.on("click",(function(){if(!c){c=!0;var l=(o=localStorage.getItem(encryption("agree"))?JSON.parse(decrypt(localStorage.getItem(encryption("agree")))):[]).includes(e);$.ajax({url:"/api/content/posts/"+e+"/likes",type:"POST",dataType:"json",data:{type:l?"disagree":"agree"},success:function(c){if(200===c.status){var s=t;if(l){s--;var d=o.findIndex((function(t){return t===e}));o.splice(d,1),a.removeClass("active"),i.addClass("active"),n.removeClass("active")}else s++,o.push(e),i.removeClass("active"),a.addClass("active"),n.addClass("active");var f=encryption("agree"),g=encryption(JSON.stringify(o));localStorage.setItem(f,g),r.html(s)}},error:function(e){return c=!1,Qmsg.warning(e.responseJSON.message)},complete:function(){c=!1}})}}))}},initVideo:function(){if($(".joe_detail__article-video").length){var e=$(".joe_detail__article-video .play iframe").attr("data-player");$(".joe_detail__article-video .episodes .item").on("click",(function(){$(this).addClass("active").siblings().removeClass("active");var t=$(this).attr("data-src");$(".joe_detail__article-video .play iframe").attr({src:e+t})})),$(".joe_detail__article-video .episodes .item").first().click()}},initMathjax:function(){ThemeConfig.enable_mathjax&&window.katex&&renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],throwOnError:!1})}},e=["initToc","foldCode"],document.addEventListener("DOMContentLoaded",(function(){Object.keys(t).forEach((function(o){return!e.includes(o)&&t[o]()}))})),window.addEventListener("load",(function(){1===e.length?t[e[0]]():e.forEach((function(e){return t[e]()}))})),{};var e,t}));